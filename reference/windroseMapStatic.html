<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="windroseMapStatic() creates a ggplot2 map using wind roses as markers. As
this function returns a ggplot2 object, further customisation can be
achieved using functions like ggplot2::theme() and ggplot2::guides(). See
openair::polarPlot() for more information."><title>Wind rose plots on a static ggmap — windroseMapStatic • openairmaps</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Wind rose plots on a static ggmap — windroseMapStatic"><meta property="og:description" content="windroseMapStatic() creates a ggplot2 map using wind roses as markers. As
this function returns a ggplot2 object, further customisation can be
achieved using functions like ggplot2::theme() and ggplot2::guides(). See
openair::polarPlot() for more information."><meta property="og:image" content="https://davidcarslaw.github.io/openairmaps/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">openairmaps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0.9009</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://bookdown.org/david_carslaw/openair/maps-overview.html">Book (External)</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Wind rose plots on a static ggmap</h1>
      
      <div class="d-none name"><code>windroseMapStatic.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>windroseMapStatic()</code> creates a <code>ggplot2</code> map using wind roses as markers. As
this function returns a <code>ggplot2</code> object, further customisation can be
achieved using functions like <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">ggplot2::guides()</a></code>. See
<code><a href="https://davidcarslaw.github.io/openair/reference/polarPlot.html" class="external-link">openair::polarPlot()</a></code> for more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">windroseMapStatic</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  ws.int <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  facet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  latitude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  longitude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  zoom <span class="op">=</span> <span class="fl">13</span>,</span>
<span>  ggmap <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"turbo"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  key <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  facet.nrow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  d.icon <span class="op">=</span> <span class="fl">150</span>,</span>
<span>  d.fig <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A data frame. The data frame must contain the data to plot the
directional analysis marker, which includes wind speed (<code>ws</code>), wind
direction (<code>wd</code>), and the column representing the concentration of a
pollutant. In addition, <code>data</code> must include a decimal latitude and
longitude.</p></dd>


<dt>ws.int</dt>
<dd><p>The wind speed interval. Default is 2 m/s but for low met masts
with low mean wind speeds a value of 1 or 0.5 m/s may be better.</p></dd>


<dt>breaks</dt>
<dd><p>Most commonly, the number of break points for wind speed in
windRose. For windRose and the ws.int default of 2 m/s, the default, 4,
generates the break points 2, 4, 6, 8 m/s. Breaks can also be used to set
specific break points. For example, the argument breaks = c(0, 1, 10, 100)
breaks the data into segments &lt;1, 1-10, 10-100, &gt;100.</p></dd>


<dt>facet</dt>
<dd><p>Used for splitting the input data into different panels, passed
to the <code>type</code> argument of <code><a href="https://davidcarslaw.github.io/openair/reference/cutData.html" class="external-link">openair::cutData()</a></code>. <code>facet</code> cannot be used if
multiple <code>pollutant</code> columns have been provided.</p></dd>


<dt>latitude, longitude</dt>
<dd><p>The decimal latitude/longitude. If not provided,
will be automatically inferred from data by looking for a column named
"lat"/"latitude" or "lon"/"lng"/"long"/"longitude" (case-insensitively).</p></dd>


<dt>zoom</dt>
<dd><p>The zoom level to use for the basemap, passed to
<code><a href="https://rdrr.io/pkg/ggmap/man/get_stamenmap.html" class="external-link">ggmap::get_stamenmap()</a></code>. Alternatively, the <code>ggmap</code> argument can be used
for more precise control of the basemap.</p></dd>


<dt>ggmap</dt>
<dd><p>By default, <code>openairmaps</code> will try to estimate an appropriate
bounding box for the input data and then run <code><a href="https://rdrr.io/pkg/ggmap/man/get_stamenmap.html" class="external-link">ggmap::get_stamenmap()</a></code> to
import a basemap. The <code>ggmap</code> argument allows users to provide their own
<code>ggmap</code> object to override this, which allows for alternative bounding
boxes, map types and colours.</p></dd>


<dt>cols</dt>
<dd><p>The colours used for plotting. See <code><a href="https://davidcarslaw.github.io/openair/reference/openColours.html" class="external-link">openair::openColours()</a></code> for
more information.</p></dd>


<dt>alpha</dt>
<dd><p>The alpha transparency to use for the plotting surface (a value
between 0 and 1 with zero being fully transparent and 1 fully opaque).</p></dd>


<dt>key</dt>
<dd><p>Should a key for each marker be drawn? Default is <code>FALSE</code>.</p></dd>


<dt>facet.nrow</dt>
<dd><p>Passed to the <code>nrow</code> argument of <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">ggplot2::facet_wrap()</a></code>.</p></dd>


<dt>d.icon</dt>
<dd><p>The diameter of the plot on the map in pixels. This will affect
the size of the individual polar markers. Alternatively, a vector in the
form <code>c(width, height)</code> can be provided if a non-circular marker is
desired.</p></dd>


<dt>d.fig</dt>
<dd><p>The diameter of the plots to be produced using <code>openair</code> in
inches. This will affect the resolution of the markers on the map.
Alternatively, a vector in the form <code>c(width, height)</code> can be provided if a
non-circular marker is desired.</p></dd>


<dt>...</dt>
<dd><p>Arguments passed on to <code><a href="https://davidcarslaw.github.io/openair/reference/polarAnnulus.html" class="external-link">openair::polarAnnulus</a></code></p><dl><dt><code>resolution</code></dt>
<dd><p>Two plot resolutions can be set: “normal” and
“fine” (the default).</p></dd>

    <dt><code>local.tz</code></dt>
<dd><p>Should the results be calculated in local time that includes
a treatment of daylight savings time (DST)? The default is not to consider
DST issues, provided the data were imported without a DST offset. Emissions
activity tends to occur at local time e.g. rush hour is at 8 am every day.
When the clocks go forward in spring, the emissions are effectively
released into the atmosphere typically 1 hour earlier during the summertime
i.e. when DST applies. When plotting diurnal profiles, this has the effect
of “smearing-out” the concentrations. Sometimes, a useful approach
is to express time as local time. This correction tends to produce
better-defined diurnal profiles of concentration (or other variables) and
allows a better comparison to be made with emissions/activity data. If set
to <code>FALSE</code> then GMT is used. Examples of usage include <code>local.tz
  = "Europe/London"</code>, <code>local.tz = "America/New_York"</code>. See
<code>cutData</code> and <code>import</code> for more details.</p></dd>

    <dt><code>type</code></dt>
<dd><p><code>type</code> determines how the data are split i.e. conditioned,
and then plotted. The default is will produce a single plot using the
entire data. Type can be one of the built-in types as detailed in
<code>cutData</code> e.g. “season”, “year”, “weekday” and so
on. For example, <code>type = "season"</code> will produce four plots --- one for
each season.</p>
<p>It is also possible to choose <code>type</code> as another variable in the data
frame. If that variable is numeric, then the data will be split into four
quantiles (if possible) and labelled accordingly. If type is an existing
character or factor variable, then those categories/levels will be used
directly. This offers great flexibility for understanding the variation of
different variables and how they depend on one another.</p>
<p>Type can be up length two e.g. <code>type = c("season", "site")</code> will
produce a 2x2 plot split by season and site. The use of two types is mostly
meant for situations where there are several sites. Note, when two types
are provided the first forms the columns and the second the rows.</p>
<p>Also note that for the <code>polarAnnulus</code> function some type/period
combinations are forbidden or make little sense. For example, <code>type =
  "season"</code> and <code>period = "trend"</code> (which would result in a plot with
too many gaps in it for sensible smoothing), or <code>type = "weekday"</code> and
<code>period = "weekday"</code>.</p></dd>

    <dt><code>statistic</code></dt>
<dd><p>The statistic that should be applied to each wind
speed/direction bin. Can be “mean” (default), “median”,
“max” (maximum), “frequency”. “stdev” (standard
deviation), “weighted.mean” or “cpf” (Conditional Probability
Function). Because of the smoothing involved, the colour scale for some of
these statistics is only to provide an indication of overall pattern and
should not be interpreted in concentration units e.g. for <code>statistic =
  "weighted.mean"</code> where the bin mean is multiplied by the bin frequency and
divided by the total frequency. In many cases using <code>polarFreq</code> will
be better. Setting <code>statistic = "weighted.mean"</code> can be useful because
it provides an indication of the concentration * frequency of occurrence
and will highlight the wind speed/direction conditions that dominate the
overall mean.</p></dd>

    <dt><code>percentile</code></dt>
<dd><p>If <code>statistic = "percentile"</code> or <code>statistic =
  "cpf"</code> then <code>percentile</code> is used, expressed from 0 to 100. Note that
the percentile value is calculated in the wind speed, wind direction
‘bins’. For this reason it can also be useful to set <code>min.bin</code>
to ensure there are a sufficient number of points available to estimate a
percentile. See <code>quantile</code> for more details of how percentiles are
calculated.</p></dd>

    <dt><code>width</code></dt>
<dd><p>The width of the annulus; can be “normal” (the default),
“thin” or “fat”.</p></dd>

    <dt><code>min.bin</code></dt>
<dd><p>The minimum number of points allowed in a wind speed/wind
direction bin.  The default is 1. A value of two requires at least 2 valid
records in each bin an so on; bins with less than 2 valid records are set
to NA. Care should be taken when using a value &gt; 1 because of the risk of
removing real data points. It is recommended to consider your data with
care. Also, the <code>polarFreq</code> function can be of use in such
circumstances.</p></dd>

    <dt><code>exclude.missing</code></dt>
<dd><p>Setting this option to <code>TRUE</code> (the default)
removes points from the plot that are too far from the original data. The
smoothing routines will produce predictions at points where no data exist
i.e. they predict. By removing the points too far from the original data
produces a plot where it is clear where the original data lie. If set to
<code>FALSE</code> missing data will be interpolated.</p></dd>

    <dt><code>date.pad</code></dt>
<dd><p>For <code>type = "trend"</code> (default), <code>date.pad = TRUE</code>
will pad-out missing data to the beginning of the first year and the end of
the last year. The purpose is to ensure that the trend plot begins and ends
at the beginning or end of year.</p></dd>

    <dt><code>force.positive</code></dt>
<dd><p>The default is <code>TRUE</code>. Sometimes if smoothing data
with steep gradients it is possible for predicted values to be negative.
<code>force.positive = TRUE</code> ensures that predictions remain positive. This
is useful for several reasons. First, with lots of missing data more
interpolation is needed and this can result in artefacts because the
predictions are too far from the original data. Second, if it is known
beforehand that the data are all positive, then this option carries that
assumption through to the prediction. The only likely time where setting
<code>force.positive = FALSE</code> would be if background concentrations were
first subtracted resulting in data that is legitimately negative. For the
vast majority of situations it is expected that the user will not need to
alter the default option.</p></dd>

    <dt><code>k</code></dt>
<dd><p>The smoothing value supplied to <code>gam</code> for the temporal and wind
direction components, respectively. In some cases e.g. a trend plot with
less than 1-year of data the smoothing with the default values may become
too noisy and affected more by outliers. Choosing a lower value of <code>k</code>
(say 10) may help produce a better plot.</p></dd>

    <dt><code>normalise</code></dt>
<dd><p>If <code>TRUE</code> concentrations are normalised by dividing by
their mean value. This is done <em>after</em> fitting the smooth surface.
This option is particularly useful if one is interested in the patterns of
concentrations for several pollutants on different scales e.g. NOx and CO.
Often useful if more than one <code>pollutant</code> is chosen.</p></dd>

    <dt><code>key.header</code></dt>
<dd><p>Adds additional text/labels to the scale key. For example,
passing the options <code>key.header = "header", key.footer = "footer1"</code>
adds addition text above and below the scale key. These arguments are
passed to <code>drawOpenKey</code> via <code>quickText</code>, applying the
<code>auto.text</code> argument, to handle formatting.</p></dd>

    <dt><code>key.footer</code></dt>
<dd><p>see <code>key.footer</code>.</p></dd>

    <dt><code>key.position</code></dt>
<dd><p>Location where the scale key is to plotted. Allowed
arguments currently include <code>"top"</code>, <code>"right"</code>, <code>"bottom"</code>
and <code>"left"</code>.</p></dd>

    <dt><code>auto.text</code></dt>
<dd><p>Either <code>TRUE</code> (default) or <code>FALSE</code>. If <code>TRUE</code>
titles and axis labels will automatically try and format pollutant names
and units properly e.g.  by subscripting the `2' in NO2.</p></dd>

  
</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a <code>ggplot2</code> plot with a <code>ggmap</code> basemap</p>
    </div>
    <div class="section level2">
    <h2 id="further-customisation-using-ggplot-">Further customisation using ggplot2<a class="anchor" aria-label="anchor" href="#further-customisation-using-ggplot-"></a></h2>
    


<p>As the outputs of the static directional analysis functions are <code>ggplot2</code>
figures, further customisation is possible using functions such as
<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">ggplot2::guides()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggplot2::labs()</a></code>.</p>
<p>If multiple pollutants are specified, subscripting (e.g., the "x" in "NOx")
is achieved using the <a href="https://wilkelab.org/ggtext/reference/ggtext.html" class="external-link">ggtext</a> package. Therefore if you
choose to override the plot theme, it is recommended to use
<code>[ggplot2::theme()]</code> and <code>[ggtext::element_markdown()]</code> to define the
<code>strip.text</code> parameter.</p>
<p>When arguments like <code>limits</code>, <code>percentile</code> or <code>breaks</code> are defined, a
legend is automatically added to the figure. Legends can be removed using
<code>ggplot2::theme(legend.position = "none")</code>, or further customised using
<code><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">ggplot2::guides()</a></code> and either <code>color = ggplot2::guide_colourbar()</code> for
continuous legends or <code>fill = ggplot2::guide_legend()</code> for discrete
legends.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>the original <code><a href="https://davidcarslaw.github.io/openair/reference/windRose.html" class="external-link">openair::windRose()</a></code></p>
<p><code><a href="windroseMap.html">windroseMap()</a></code> for the interactive <code>leaflet</code> equivalent of
<code>windroseMapStatic()</code></p>
<p>Other static directional analysis maps: 
<code><a href="annulusMapStatic.html">annulusMapStatic</a>()</code>,
<code><a href="diffMapStatic.html">diffMapStatic</a>()</code>,
<code><a href="freqMapStatic.html">freqMapStatic</a>()</code>,
<code><a href="percentileMapStatic.html">percentileMapStatic</a>()</code>,
<code><a href="polarMapStatic.html">polarMapStatic</a>()</code>,
<code><a href="pollroseMapStatic.html">pollroseMapStatic</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jack Davison, David Carslaw.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

