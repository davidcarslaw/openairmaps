<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="percentileMap() creates a leaflet map using percentile roses as
markers. Any number of pollutants can be specified using the pollutant
argument, and multiple layers of markers can be added and toggled between
using control."><title>Percentile roses on interactive leaflet maps — percentileMap • openairmaps</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Percentile roses on interactive leaflet maps — percentileMap"><meta property="og:description" content="percentileMap() creates a leaflet map using percentile roses as
markers. Any number of pollutants can be specified using the pollutant
argument, and multiple layers of markers can be added and toggled between
using control."><meta property="og:image" content="https://davidcarslaw.github.io/openairmaps/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">openairmaps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.1.9004</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://bookdown.org/david_carslaw/openair/maps-overview.html">Book (External)</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Percentile roses on interactive leaflet maps</h1>
      
      <div class="d-none name"><code>percentileMap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>percentileMap()</code> creates a <code>leaflet</code> map using percentile roses as
markers. Any number of pollutants can be specified using the <code>pollutant</code>
argument, and multiple layers of markers can be added and toggled between
using <code>control</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">percentileMap</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  pollutant <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  percentile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">90</span>, <span class="fl">95</span><span class="op">)</span>,</span>
<span>  latitude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  longitude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  popup <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  provider <span class="op">=</span> <span class="st">"OpenStreetMap"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"turbo"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  key <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  draw.legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  collapse.control <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  d.icon <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  d.fig <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>  type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A data frame. The data frame must contain the data to plot the
directional analysis marker, which includes wind speed (<code>ws</code>), wind
direction (<code>wd</code>), and the column representing the concentration of a
pollutant. In addition, <code>data</code> must include a decimal latitude and
longitude.</p></dd>


<dt>pollutant</dt>
<dd><p>The column name(s) of the pollutant(s) to plot. If multiple
pollutants are specified, they can be toggled between using a "layer
control" interface.</p></dd>


<dt>percentile</dt>
<dd><p>The percentile value(s) to plot. Must be between 0–100. If
<code>percentile = NA</code> then only a mean line will be shown.</p></dd>


<dt>latitude, longitude</dt>
<dd><p>The decimal latitude/longitude. If not provided,
will be automatically inferred from data by looking for a column named
"lat"/"latitude" or "lon"/"lng"/"long"/"longitude" (case-insensitively).</p></dd>


<dt>control</dt>
<dd><p>Column to be used for splitting the input data into different
groups which can be selected between using a "layer control" interface.
Appropriate columns could be those added by <code><a href="https://davidcarslaw.github.io/openair/reference/cutData.html" class="external-link">openair::cutData()</a></code> or
<code><a href="https://davidcarslaw.github.io/openair/reference/splitByDate.html" class="external-link">openair::splitByDate()</a></code>. <code>control</code> cannot be used if multiple <code>pollutant</code>
columns have been provided.</p></dd>


<dt>popup</dt>
<dd><p>Column to be used as the HTML content for marker popups. Popups
may be useful to show information about the individual sites (e.g., site
names, codes, types, etc.).</p></dd>


<dt>label</dt>
<dd><p>Column to be used as the HTML content for hover-over labels.
Labels are useful for the same reasons as popups, though are typically
shorter.</p></dd>


<dt>provider</dt>
<dd><p>The base map(s) to be used. See
<a href="http://leaflet-extras.github.io/leaflet-providers/preview/" class="external-link">http://leaflet-extras.github.io/leaflet-providers/preview/</a> for a list of
all base maps that can be used. If multiple base maps are provided, they
can be toggled between using a "layer control" interface.</p></dd>


<dt>cols</dt>
<dd><p>The colours used for plotting. See <code><a href="https://davidcarslaw.github.io/openair/reference/openColours.html" class="external-link">openair::openColours()</a></code> for
more information.</p></dd>


<dt>alpha</dt>
<dd><p>The alpha transparency to use for the plotting surface (a value
between 0 and 1 with zero being fully transparent and 1 fully opaque).</p></dd>


<dt>key</dt>
<dd><p>Should a key for each marker be drawn? Default is <code>FALSE</code>.</p></dd>


<dt>draw.legend</dt>
<dd><p>Should a shared legend be created at the side of the map?
Default is <code>TRUE</code>.</p></dd>


<dt>collapse.control</dt>
<dd><p>Should the "layer control" interface be collapsed?
Defaults to <code>FALSE</code>.</p></dd>


<dt>d.icon</dt>
<dd><p>The diameter of the plot on the map in pixels. This will affect
the size of the individual polar markers. Alternatively, a vector in the
form <code>c(width, height)</code> can be provided if a non-circular marker is
desired.</p></dd>


<dt>d.fig</dt>
<dd><p>The diameter of the plots to be produced using <code>openair</code> in
inches. This will affect the resolution of the markers on the map.
Alternatively, a vector in the form <code>c(width, height)</code> can be provided if a
non-circular marker is desired.</p></dd>


<dt>type</dt>
<dd><p>Deprecated. Please use <code>label</code> and/or <code>popup</code> to label different
sites.</p></dd>


<dt>...</dt>
<dd><p>Arguments passed on to <code><a href="https://davidcarslaw.github.io/openair/reference/percentileRose.html" class="external-link">openair::percentileRose</a></code></p><dl><dt><code>wd</code></dt>
<dd><p>Name of wind direction field.</p></dd>

    <dt><code>smooth</code></dt>
<dd><p>Should the wind direction data be smoothed using a cyclic
spline?</p></dd>

    <dt><code>method</code></dt>
<dd><p>When <code>method = "default"</code> the supplied percentiles by wind
direction are calculated. When <code>method = "cpf"</code> the conditional
probability function (CPF) is plotted and a single (usually high)
percentile level is supplied. The CPF is defined as CPF = my/ny, where my
is the number of samples in the wind sector y with mixing ratios greater
than the <em>overall</em> percentile concentration, and ny is the total
number of samples in the same wind sector (see Ashbaugh et al., 1985).</p></dd>

    <dt><code>angle</code></dt>
<dd><p>Default angle of “spokes” is when <code>smooth = FALSE</code>.</p></dd>

    <dt><code>mean</code></dt>
<dd><p>Show the mean by wind direction as a line?</p></dd>

    <dt><code>mean.lty</code></dt>
<dd><p>Line type for mean line.</p></dd>

    <dt><code>mean.lwd</code></dt>
<dd><p>Line width for mean line.</p></dd>

    <dt><code>mean.col</code></dt>
<dd><p>Line colour for mean line.</p></dd>

    <dt><code>fill</code></dt>
<dd><p>Should the percentile intervals be filled (default) or should
lines be drawn (<code>fill = FALSE</code>).</p></dd>

    <dt><code>intervals</code></dt>
<dd><p>User-supplied intervals for the scale e.g. <code>intervals =
c(0, 10, 30, 50)</code></p></dd>

    <dt><code>angle.scale</code></dt>
<dd><p>Sometimes the placement of the scale may interfere with an
interesting feature. The user can therefore set <code>angle.scale</code> to
any value between 0 and 360 degrees to mitigate such problems. For
example <code>angle.scale = 45</code> will draw the scale heading in a NE
direction.</p></dd>

    <dt><code>auto.text</code></dt>
<dd><p>Either <code>TRUE</code> (default) or <code>FALSE</code>. If <code>TRUE</code>
titles and axis labels will automatically try and format pollutant names
and units properly e.g.  by subscripting the `2' in NO2.</p></dd>

    <dt><code>key.header</code></dt>
<dd><p>Adds additional text/labels to the scale key. For example,
passing the options <code>key.header = "header", key.footer = "footer1"</code>
adds addition text above and below the scale key. These arguments are
passed to <code>drawOpenKey</code> via <code>quickText</code>, applying the
<code>auto.text</code> argument, to handle formatting.</p></dd>

    <dt><code>key.footer</code></dt>
<dd><p>see <code>key.footer</code>.</p></dd>

    <dt><code>key.position</code></dt>
<dd><p>Location where the scale key is to plotted. Allowed
arguments currently include <code>"top"</code>, <code>"right"</code>, <code>"bottom"</code>
and <code>"left"</code>.</p></dd>

  
</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A leaflet object.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>the original <code><a href="https://davidcarslaw.github.io/openair/reference/percentileRose.html" class="external-link">openair::percentileRose()</a></code></p>
<p><code><a href="percentileMapStatic.html">percentileMapStatic()</a></code> for the static <code>ggmap</code> equivalent of
<code>percentileMap()</code></p>
<p>Other interactive directional analysis maps: 
<code><a href="annulusMap.html">annulusMap</a>()</code>,
<code><a href="diffMap.html">diffMap</a>()</code>,
<code><a href="freqMap.html">freqMap</a>()</code>,
<code><a href="polarMap.html">polarMap</a>()</code>,
<code><a href="pollroseMap.html">pollroseMap</a>()</code>,
<code><a href="windroseMap.html">windroseMap</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">percentileMap</span><span class="op">(</span><span class="va">polar_data</span>,</span></span>
<span class="r-in"><span>  pollutant <span class="op">=</span> <span class="st">"nox"</span>,</span></span>
<span class="r-in"><span>  provider <span class="op">=</span> <span class="st">"Stamen.Toner"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jack Davison, David Carslaw.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

